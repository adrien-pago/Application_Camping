-- phpMyAdmin SQL Dump
-- version 5.2.1
-- https://www.phpmyadmin.net/
--
-- Hôte : localhost:3306
-- Généré le : dim. 12 nov. 2023 à 13:54
-- Version du serveur : 10.5.19-MariaDB-0+deb11u2
-- Version de PHP : 8.2.11

SET SQL_MODE = "NO_AUTO_VALUE_ON_ZERO";
START TRANSACTION;
SET time_zone = "+00:00";

/*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
/*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
/*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */;
/*!40101 SET NAMES utf8mb4 */;

-- --------------------------------------------------------
-- Structure de la table `CAMPING`
CREATE TABLE `CAMPING` (
  `ID_CAMPING` int(11) NOT NULL,
  `NOM_CAMPING` varchar(50) NOT NULL,
  `EMAIL` varchar(50) NOT NULL,
  `NUM_SIRET` int(20) NOT NULL,
  `MAP` blob DEFAULT NULL,
  `PASSWORD` varchar(1000) NOT NULL,
  `TOKEN_CONFIRM` int(2) DEFAULT NULL,
  `TOP_USER_CONFIRMED` int(2) NOT NULL,
  `ID_STRUCTURE` int(11) NOT NULL,
  PRIMARY KEY (`ID_CAMPING`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_general_ci;

-- Structure de la table `STRUCTURE`
CREATE TABLE `STRUCTURE` (
  `ID_STRUCTURE` int(11) NOT NULL,
  `ID_CAMPING` int(11) NOT NULL,
  `LIBELLE_STRUCTURE` varchar(50) NOT NULL,
  `NB_STRUCTURE` int(5) NOT NULL,
  `ID_ACTIVITE` int(11) NOT NULL,
  `ETAT_STRUCTURE` enum('Disponible','Indisponible','Réparation','Préparation') DEFAULT NULL,
  PRIMARY KEY (`ID_STRUCTURE`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_general_ci;

-- Structure de la table `ACTIVITE`
CREATE TABLE `ACTIVITE` (
  `ID_ACTIVITE` int(11) NOT NULL,
  `ID_STRUCTURE` int(11) NOT NULL,
  `LIBELLE_ACT` varchar(50) NOT NULL,
  `ID_VAC_ACT` int(11) DEFAULT NULL,
  PRIMARY KEY (`ID_ACTIVITE`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_general_ci;

-- Structure de la table `VACANCIER`
CREATE TABLE `VACANCIER` (
  `ID_VACANCIER` int(11) NOT NULL,
  `NOM` varchar(20) NOT NULL,
  `PRENOM` varchar(20) NOT NULL,
  `TEL` varchar(20) NOT NULL,
  `SEXE` varchar(10) NOT NULL,
  `EMAIL` varchar(50) NOT NULL,
  `DATE_DEB_VAC` date NOT NULL,
  `DATE_FIN_VAC` date NOT NULL,
  PRIMARY KEY (`ID_VACANCIER`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_general_ci;

-- Structure de la table `VAC_ACT`
CREATE TABLE `VAC_ACT` (
  `ID_ACT_VAC` int(11) NOT NULL,
  `ID_ACTIVITE` int(11) NOT NULL,
  `ID_VACANCIER` int(11) NOT NULL,
  `DATE_HEURE` date NOT NULL,
  PRIMARY KEY (`ID_ACT_VAC`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_general_ci;

-- Structure de la table `CAMPING_ACTION`
CREATE TABLE `CAMPING_ACTION` (
  `ID_CAMPING_ACTION` int(11) NOT NULL,
  `DATE_HEURE` int(11) NOT NULL,
  `ID_ACTIVITE` int(11) NOT NULL,
  `ID_CAMPING` int(11) NOT NULL,
  PRIMARY KEY (`ID_CAMPING_ACTION`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_general_ci;

-- Structure de la table `PLANNING`
CREATE TABLE `PLANNING` (
  `ID_PLANNING` int(11) NOT NULL,
  `ID_ACT_VAC` int(11) NOT NULL,
  `ID_CAMPING_ACTION` int(11) NOT NULL,
  `DATE_HEURE_DEBUT` date NOT NULL,
  `LIB_ACTIVITE` varchar(50) NOT NULL,
  `DATE_HEURE_FIN` date NOT NULL,
  PRIMARY KEY (`ID_PLANNING`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_general_ci;

-- --------------------------------------------------------

-- AUTO_INCREMENT pour les tables

ALTER TABLE `ACTIVITE` MODIFY `ID_ACTIVITE` int(11) NOT NULL AUTO_INCREMENT;
ALTER TABLE `CAMPING` MODIFY `ID_CAMPING` int(11) NOT NULL AUTO_INCREMENT;
ALTER TABLE `CAMPING_ACTION` MODIFY `ID_CAMPING_ACTION` int(11) NOT NULL AUTO_INCREMENT;
ALTER TABLE `STRUCTURE` MODIFY `ID_STRUCTURE` int(11) NOT NULL AUTO_INCREMENT;
ALTER TABLE `VACANCIER` MODIFY `ID_VACANCIER` int(11) NOT NULL AUTO_INCREMENT;
ALTER TABLE `VAC_ACT` MODIFY `ID_ACT_VAC` int(11) NOT NULL AUTO_INCREMENT;

-- --------------------------------------------------------

-- Ajout des contraintes de clé étrangère

ALTER TABLE `STRUCTURE`
ADD FOREIGN KEY (`ID_CAMPING`) REFERENCES `CAMPING`(`ID_CAMPING`);

ALTER TABLE `ACTIVITE`
ADD FOREIGN KEY (`ID_STRUCTURE`) REFERENCES `STRUCTURE`(`ID_STRUCTURE`);

ALTER TABLE `VAC_ACT`
ADD FOREIGN KEY (`ID_ACTIVITE`) REFERENCES `ACTIVITE`(`ID_ACTIVITE`),
ADD FOREIGN KEY (`ID_VACANCIER`) REFERENCES `VACANCIER`(`ID_VACANCIER`);

ALTER TABLE `CAMPING_ACTION`
ADD FOREIGN KEY (`ID_ACTIVITE`) REFERENCES `ACTIVITE`(`ID_ACTIVITE`),
ADD FOREIGN KEY (`ID_CAMPING`) REFERENCES `CAMPING`(`ID_CAMPING`);

ALTER TABLE `PLANNING`
ADD FOREIGN KEY (`ID_ACT_VAC`) REFERENCES `VAC_ACT`(`ID_ACT_VAC`),
ADD FOREIGN KEY (`ID_CAMPING_ACTION`) REFERENCES `CAMPING_ACTION`(`ID_CAMPING_ACTION`);


COMMIT;

/*!40101 SET CHARACTER_SET_CLIENT=@OLD_CHARACTER_SET_CLIENT */;
/*!40101 SET CHARACTER_SET_RESULTS=@OLD_CHARACTER_SET_RESULTS */;
/*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */;
